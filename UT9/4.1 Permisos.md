# Gestión de Permisos en Odoo con `ir.model.access.csv`

En Odoo, los permisos de acceso se gestionan principalmente a través del archivo **`ir.model.access.csv`**, que define los derechos CRUD (Crear, Leer, Actualizar y Eliminar) para modelos específicos y grupos de seguridad. Este archivo se utiliza para establecer reglas básicas sobre qué operaciones pueden realizar los usuarios en los modelos.

---

## Archivo `ir.model.access.csv`

El archivo **`ir.model.access.csv`** debe ubicarse en la carpeta `security` de tu módulo. Su formato es el siguiente:

~~~csv
id,name,model_id:id,group_id:id,perm_read,perm_write,perm_create,perm_unlink
~~~

### Campos
- **`id`**: Identificador único para la regla de acceso.
- **`name`**: Nombre descriptivo para la regla.
- **`model_id:id`**: Identificador del modelo al que aplica la regla (por ejemplo, `model_star_wars_planet`).
- **`group_id:id`**: Grupo de usuarios para los que aplica la regla (por ejemplo, `group_star_wars_alumno`).
- **`perm_read`**: Permiso para leer registros (`1`: Sí, `0`: No).
- **`perm_write`**: Permiso para editar registros (`1`: Sí, `0`: No).
- **`perm_create`**: Permiso para crear nuevos registros (`1`: Sí, `0`: No).
- **`perm_unlink`**: Permiso para eliminar registros (`1`: Sí, `0`: No).

---

## Ejemplo: Permitir Acceso a un Usuario "Alumno" al Modelo `star_wars.planet`

### Archivo `ir.model.access.csv`

Crea o edita el archivo `security/ir.model.access.csv` en tu módulo:

~~~csv
id,name,model_id:id,group_id:id,perm_read,perm_write,perm_create,perm_unlink
access_star_wars_planet_alumno,Alumno Access to Star Wars Planet,model_star_wars_planet,group_star_wars_alumno,1,0,0,0
~~~

#### Explicación
- **`access_star_wars_planet_alumno`**: ID único para esta regla.
- **`Alumno Access to Star Wars Planet`**: Nombre descriptivo.
- **`model_star_wars_planet`**: Se refiere al modelo `star_wars.planet`.
- **`group_star_wars_alumno`**: Aplica esta regla solo al grupo "Alumno Star Wars".
- **Permisos CRUD**:
  - `perm_read`: Los usuarios del grupo pueden leer registros (`1`).
  - `perm_write`, `perm_create`, `perm_unlink`: No tienen permisos para estas operaciones (`0`).

---

## Crear el Grupo de Seguridad para "Alumno"

Define un grupo de seguridad llamado **"Alumno Star Wars"** en el archivo XML.

~~~xml
<odoo>
    <data>
        <record id="group_star_wars_alumno" model="res.groups">
            <field name="name">Alumno Star Wars</field>
            <field name="category_id" ref="base.module_category_hidden"/>
        </record>
    </data>
</odoo>
~~~

---

## Configurar las Vistas para el Grupo "Alumno"

### Limitar el Acceso a las Vistas
Puedes limitar el acceso a las vistas del modelo `star_wars.planet` al grupo "Alumno Star Wars":

~~~xml
<odoo>
    <data>
        <!-- Vista de lista del modelo star_wars.planet -->
        <record id="view_star_wars_planet_tree" model="ir.ui.view">
            <field name="name">Planetas Star Wars Lista</field>
            <field name="model">star_wars.planet</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                    <field name="capital_city"/>
                </tree>
            </field>
            <field name="groups_id" eval="[(4, ref('group_star_wars_alumno'))]"/>
        </record>
        
        <!-- Vista de formulario del modelo star_wars.planet -->
        <record id="view_star_wars_planet_form" model="ir.ui.view">
            <field name="name">Planetas Star Wars Formulario</field>
            <field name="model">star_wars.planet</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <field name="name"/>
                            <field name="capital_city"/>
                        </group>
                    </sheet>
                </form>
            </field>
            <field name="groups_id" eval="[(4, ref('group_star_wars_alumno'))]"/>
        </record>
    </data>
</odoo>
~~~

---

## Registrar el Archivo de Seguridad

Asegúrate de registrar el archivo `ir.model.access.csv` en el archivo `__manifest__.py` de tu módulo:

~~~python
{
    'name': 'Star Wars Module',
    'version': '1.0',
    'depends': ['base'],
    'data': [
        'security/ir.model.access.csv',  # Registrar archivo de permisos
        'security/security.xml',        # Registrar grupos de seguridad
        'views/star_wars_planet_views.xml',
    ],
    'installable': True,
}
~~~

---

## Verificar los Permisos

1. **Usuario**: Asigna el grupo "Alumno Star Wars" al usuario "Alumno".
2. **Pruebas**:
   - Inicia sesión como el usuario "Alumno".
   - Verifica que puede acceder a las vistas del modelo `star_wars.planet`.
   - Asegúrate de que no pueda crear, editar ni eliminar registros.
